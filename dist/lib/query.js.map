{"version":3,"file":"query.js","sourceRoot":"","sources":["../../src/lib/query.ts"],"names":[],"mappings":"AAAA,OAAO,MAAM,MAAM,yBAAyB,CAAC;AAE7C,MAAM,CAAC,KAAK,UAAU,WAAW;IAC7B,MAAM,GAAG,GAAG;;;;;;;;;;;;;;;;;;;;KAoBX,CAAC;IAEF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEzC,0CAA0C;IAE1C,OAAO,IAAI,CAAA;AACf,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,WAAW;IAC7B,MAAM,GAAG,GAAG;;;;;KAKX,CAAC;IAEF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAEzC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,UAAU,CAAC,OAAe,EAAE,IAAY,EAAE,OAAe;IAC3E,MAAM,GAAG,GAAG;;KAEX,CAAC;IAEF,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAA;AACrD,CAAC","sourcesContent":["import client from '../config/connection.js';\r\n\r\nexport async function getAllShops() {\r\n    const sql = `\r\n    SELECT\r\n    shops.id AS shop_id,\r\n    name AS shop_name,\r\n    address AS shop_address,\r\n    users.id AS user_id,\r\n    CONCAT(users.first_name, ' ', users.last_name) AS user_name,\r\n    users.email AS user_email,\r\n    CONCAT (managers.first_name, ' ', managers.last_name) AS\r\n    manager,\r\n    wines.id AS wine_id,\r\n    brand AS wine_name,\r\n    type AS wine_price\r\n    FROM shops\r\n    JOIN users\r\n    On shops.user_id = users.id\r\n    LEFT JOIN wines\r\n    ON shops.id = wines.shop_id\r\n    LEFT JOIN users AS managers\r\n    ON users.manager_id = managers.id\r\n    `;\r\n\r\n    const { rows } = await client.query(sql);\r\n\r\n    // console.log('get all shop rows', rows);\r\n\r\n    return rows\r\n}\r\n\r\nexport async function getAllUsers() {\r\n    const sql = `\r\n    SELECT\r\n    id,\r\n    CONCAT(firts_name, ' ',last_name) AS user_name\r\n    FROM users\r\n    `;\r\n\r\n    const { rows } = await client.query(sql);\r\n\r\n    return rows;\r\n}\r\n\r\nexport async function createShop(user_id: number, name: string, address: string) {\r\n    const sql = `\r\n    INSERT INTO shops (name, address, user_id) VALUES ($1, $2, $3)\r\n    `;\r\n\r\n    await client.query(sql, [name, address, user_id])\r\n}"]}